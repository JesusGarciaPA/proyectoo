<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Análisis</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css" type="text/css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
</head>

<body>
    <div class="container">
        <div class="b_navegacion">
            <ul>
                <li><a href="diagrama" style="font-family: Tahoma; color: #FFFFFF; font-weight: bold;">Diagrama de Venn</a></li>
                <li><a href="modelo" style="font-family: Tahoma; color: #FFFFFF; font-weight: bold;">Modelo Entidad-Relación</a></li>
            </ul>
        </div>
        <br><br><br>
        <h1 style="font-family: Tahoma; color: #000000; font-weight: bold; text-align: center; font-weight: bold; font-size: 30px;">Análisis Estadístico</h1>

        <input style="font-family: Tahoma; color: #000000; font-size: 23px;" type="file" id="archivoInput" accept=".xlsx" required>

        <br>

        <label style="font-family: Tahoma; color: #000000; font-size: 23px;" for="columna">Nombre de la columna para calcular la suma:</label>
        <input type="text" id="nombreColumna" required>

        <br>

        <button onclick="calcularEstadisticas()">Calcular</button>

        <h3 style="font-family: Tahoma; color: #000000; font-weight: bold;  font-size: 23px;">Contenido del Archivo:</h3>
        <pre id="contenidoArchivo" style="font-family: Tahoma; color: #000000; font-weight: bold;"></pre>

        <!-- Agregamos una tabla HTML -->
        <div id="tablaContenedor">
            <h3 style="font-family: Tahoma; color: #000000; font-weight: bold;  font-size: 23px;">Tabla de Datos:</h3>
            <table id="datosTabla" border="1">
                <!-- Encabezados de la tabla -->
                <thead>
                    <tr id="encabezadosTabla">
                        <!-- Se agregarán dinámicamente con JavaScript -->
                    </tr>
                </thead>
                <!-- Cuerpo de la tabla -->
                <tbody id="cuerpoTabla">
                    <!-- Se agregarán dinámicamente con JavaScript -->
                </tbody>
            </table>
        </div>

        <div class="cont_cards">
            <p id="sumaResultado" style="font-family: Tahoma; color: #000000; font-weight: bold; text-align: center; font-size: 25px;"></p>
            <p id="mediaResultado" style="font-family: Tahoma; color: #000000; font-weight: bold; text-align: center; font-size: 25px;"></p>
            <p id="modaResultado" style="font-family: Tahoma; color: #000000; font-weight: bold; text-align: center; font-size: 25px;"></p>
            <p id="medianaResultado" style="font-family: Tahoma; color: #000000; font-weight: bold; text-align: center; font-size: 25px;"></p>
        </div>

        <script>
            function calcularEstadisticas() {
                // ... (el resto del código permanece sin cambios)

                // Añadir la creación dinámica de la tabla
                var encabezados = Object.keys(data[0]);
                var tabla = document.getElementById("datosTabla");

                // Ordenar encabezados alfabéticamente
                encabezados.sort();

                // Agregar encabezados
                var encabezadosRow = document.getElementById("encabezadosTabla");
                encabezadosRow.innerHTML = "";
                encabezados.forEach(function (encabezado) {
                    var th = document.createElement("th");
                    th.textContent = encabezado;
                    encabezadosRow.appendChild(th);
                });

                // Ordenar datos alfabéticamente
                data.sort(function(a, b) {
                    return a[nombreColumna].localeCompare(b[nombreColumna]);
                });

                // Agregar filas de datos
                var cuerpoTabla = document.getElementById("cuerpoTabla");
                cuerpoTabla.innerHTML = "";
                data.forEach(function (fila) {
                    var tr = document.createElement("tr");
                    encabezados.forEach(function (encabezado) {
                        var td = document.createElement("td");
                        td.textContent = fila[encabezado];
                        tr.appendChild(td);
                    });
                    cuerpoTabla.appendChild(tr);
                });

                // ... (el resto del código permanece sin cambios)
            }
        </script>
    </div>
</body>

</html>
